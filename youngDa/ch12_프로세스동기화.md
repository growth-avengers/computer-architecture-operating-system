# ch12. 프로세스 동기화

## 12-1. 동기화란

### 동기화의 의미

동시다발적으로 실행되는 많은 프로세스들은 독립적이지만 공동의 목표를 위해 협력하는 존재임

- 프로세스 동기화 : 프로세스 사이의 수행 시기를 맞추는 것
  - 실행 순서 제어 : 프로세스를 올바른 순서대로 실행하기
  - 상호 배제(mutual exclusion) : 동시에 접근해서는 안되는 자원에 하나의 프로세스만접근하게 하기

### 생산자와 소비자 문제

- 물건을 계속해서 생산하는 프로세스인 생산자와, 물건을 계속해서 소비하는 프로세스인 소비자로 이루어져 있음
- 생산자와 소비자는 "총합" 데이터를 공유.
- 생산자는 버퍼에 물건을 넣은 후 총합을 1 증가시키고, 소비자는 빼낸후 총합에 해당하는변수를 1 감소

### 공유자원과 임계구역

- 공유자원(shared resource) : 생산자와 소비자의 "총합" 데이터와 같이 공동의 자원. 전역변수,파일,입출력장치,보조기억장치가 될 수 있음
- 임계구역(critical section) : 동시에 실행하면 문제가 발생하는 자원에 접근하는 코드영역
- 레이스 컨디션(race condition) : 임계구역에서 여러 코드가 동시 실행되어 문제가 되는 겨우
  - 데이터 일관성 깨지는 문제 발생

운영체제가 임계구역 문제를 해결하는 원칙(상호배제를 위한 동기화를 위해서 지키는 규칙)

- 상호배제(mutal exclusion) : 한 프로세스가 임계구역에 진입했다면 다른 프로세스는 임계구역에 들어갈 수 없음
- 진행(progress) : 임계구역에 어느 프로세스도 진입하지 않았다면 임계구역에 진입하고자 하는 프로세스는 들어갈 수 있어야 함
- 유한 대기(bounded wating) : 한 프로세스가 임계구역에 진입하고 싶다면 그 프로세스는 언젠가는 임계구역에 들어올 수 있어야 함(무한 대기X)

## 12-2. 동기화 기법

### 뮤텍스 락

- 동시에 접근해서는 안되는 자원에 동시에 접근하지 않도록 해주는 도구
- 상호배제를 위한 동기화 도구
- 뮤텍스 락을 통해 임계구역에 자물쇠를 걸어둘 수 있음.

뮤텍스락은 단순하게는 하나의 전역변수와 두 개의 함수로 구현 가능

- 자물쇠 역할 : 프로세스들이 공유하는 전역변수 Lock
- 임계구역 잠그는 역할 : acquire 함수
  - 임계구역 진입 전 호출하는 함수.
  - 임계구역 잠겨있다면 임계구역 열릴 때 까지 확인하고, 열려있다면 잠그는 역할
- 임계구역 잠금을 해제하는 역할 : release
  - 임계구역 작업 끝난 뒤 호출하는 함수

### 세마포

- 뮤텍스락과 비슷하지만 좀 더 일반화된 방식의 동기화 도구
- 뮤텍스락은 하나의 자원에 대해서만 다룸. 세마포는 여러 자원에 대한 접근을 제어함

세마포를 간략하게 구현 : 하나의 변수와 두 개의 함수

- 전역변수 S : 임계구역에 진입할 수 있는 프로세스 개수(사용 가능한 공유 자원 개수)
- wait 함수 : 임계구역에 들어가도 좋은지, 기다려야 할지 알려주는 함수
- signal 함수 : 임계구역 앞에서 기다리는 프로세스에 이제 가도 좋다고 신호를 주는 함수

사용 가능한 공유자원 없는 경우, 무한 반복하며 S를 확인해야 함(바쁜 대기 반복)

- 세마포는 이를 해결하기 위해 wait이 자원이 없으면 해당 프로세스를 대기상태로 만들고, PCB를 세마포를 위한 대기큐에 넣음
- 다른 프로세스가 signal 호출하면 대기큐에서 제거한 후, 준비상태로 변경한 뒤 준비큐로 넣어줌

### 모니터

- 공유자원에 접근하기 위한 인터페이스(통로)를 묶어 관리.
- 조건 변수(condition variable) : 특정 조건을 바탕으로 프로세스를 실행하고 일시 중단하기 위해 사용하는 것. 프로세스나 스레드 실행 순서를 제어

# 내 생각

- 실제로 많이 들어본 단어들(뮤텍스 락, 세마포)의 프로세스에 대해 정리할 수 있어 좋았습니다.

# 논의할 내용
